  <div class="container">
    <div class="card">
      <p-table
       #dt2
       [value]="contactsForm()!"
       selectionMode="single"
       [loading]="loading()"
       (onRowSelect)="onRowSelect($event)"
       [selection]="contactSelected()"
       [showLoader]="false"
       dataKey="id"
       [rows]="10"
       [rowsPerPageOptions]="[10, 25, 50]"
       [paginator]="true"
       [globalFilterFields]="['name', 'email', 'phone', 'created_at']"
       [tableStyle]="{ 'min-width': '50rem' }"
   >
       <ng-template #caption>
           <div class="flex">
               <p-iconfield iconPosition="left" class="ml-auto">
                   <p-inputicon>
                       <i class="pi pi-search"></i>
                   </p-inputicon>
                   <input
                       pInputText
                       type="text"
                       (input)="applyFilter($event)"
                       placeholder="Buscar contacto"
                   />
               </p-iconfield>
           </div>
       </ng-template>

       <ng-template #header>
           <tr>
               <th style="width:30%">Nombre</th>
               <th style="width:30%">Email</th>
               <th style="width:30%">Teléfono</th>
               <th style="width:10%">Creado</th>
           </tr>
       </ng-template>
         <ng-template #loadingbody let-columns="columns">
           @for (item of [1,2,3,4,5]; track $index) {
                <tr>
                  <td><p-skeleton /></td>
                  <td><p-skeleton /></td>
                  <td><p-skeleton /></td>
                  <td><p-skeleton /></td>
                </tr>
              }
         </ng-template>
         <ng-template #body let-contact>
            @if (!loading()) {
              <tr [pSelectableRow]="contact">
                  <td>
                      {{ contact.name  }}
                  </td>
                  <td>
                      {{ contact.email }}
                  </td>
                  <td>
                      {{ contact.phone }}
                  </td>
                  <td>
                      {{ contact.created_at | date:'dd/MM/yyyy HH:mm' }}
                  </td>
              </tr>
            }
         </ng-template>
         <ng-template #emptymessage>
             <tr>
                 <td colspan="5">No se encontraron formularios de contacto.</td>
             </tr>
         </ng-template>
   </p-table>
   </div>

  </div>

<p-toast />

<p-dialog [modal]="true" [closable]="false" [visible]="contactSelected() ? true : false" [style]="{ width: '25rem' }">
    <div class="flex items-center gap-4 mb-8">
        <label for="username" class="font-semibold w-24">Nombre</label>
        <p>{{ contactSelected()?.name }}</p>
      </div>
      <div class="flex items-center gap-4 mb-8">
        <label for="email" class="font-semibold w-24">Email</label>
        <p>{{ contactSelected()?.email }}</p>
      </div>
      <div class="flex items-center gap-4 mb-8">
        <label for="email" class="font-semibold w-24">Teléfono</label>
        <p>{{ contactSelected()?.phone }}</p>
      </div>
      <div class="flex items-center gap-4 mb-8">
        <label for="email" class="font-semibold w-24">Mensaje</label>
        <p>{{ contactSelected()?.message }}</p>
      </div>
      <div class="flex items-center gap-4 mb-8">
        <label for="email" class="font-semibold w-24">Creado</label>
        <p>{{ contactSelected()?.created_at | date:'dd/MM/yyyy HH:mm' }}</p>
      </div>
    <div class="flex justify-end gap-2">
        <p-button label="Cerrar" (onClick)="contactSelected.set(null)" severity="secondary"  />
        <p-button label="Borrar " severity="danger" (onClick)="eliminarContact($event)" />
    </div>
</p-dialog>
 <p-confirmpopup />
